!function(){"use strict";const e=document.querySelector("#profile-title-input"),t=document.querySelector("#profile-description-input"),s=document.querySelector("#profile-edit-button"),n=document.querySelector("#card-add-button"),r=document.forms["new-card-form"],i=document.forms["profile-edit-form"],o={inputSelector:".modal__input",submitButtonSelector:".modal__save-btn",inactiveButtonClass:"modal__save-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};var a=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError=e=>{const t=this._formElement.querySelector(`#${e.id}-error`);t.textContent=e.validationMessage,e.classList.add(this._inputErrorClass),t.classList.add(this._errorClass)};_hideInputError=e=>{const t=this._formElement.querySelector(`#${e.id}-error`);t.textContent="",t.classList.remove(this._errorClass),e.classList.remove(this._inputErrorClass)};_checkInputValidity=e=>{if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)};_hasInvalidInput=e=>e.some((e=>!e.validity.valid));disableButton=()=>{this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0};_enableButton=()=>{this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1};toggleButtonState=()=>{this._hasInvalidInput(this._inputList)?this.disableButton():this._enableButton()};_setEventListeners=()=>{this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))};enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}},l=class{constructor(e,t){let{data:s,handleImageClick:n}=e;this._name=s.name,this._link=s.link,this._cardSelector=t,this._handleImageClick=n}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}generateCard(){this._element=this._getTemplate(),this._setEventListeners();const e=this._element.querySelector(".card__image"),t=this._element.querySelector(".card__title");return e.setAttribute("src",this._link),t.setAttribute("alt",this._name),t.textContent=this._name,this._element}_setEventListeners(){const e=this._element.querySelector(".card__image"),t=this._element.querySelector(".card__like-button"),s=this._element.querySelector(".card__delete-button");e.addEventListener("click",(()=>{this._handleImageClick({name:this._name,src:this._link})})),t.addEventListener("click",this._handleLikeIcon),s.addEventListener("click",this._handleDeleteCard)}_handleLikeIcon(e){e.target.classList.toggle("card__like-button_active")}_handleDeleteCard(e){e.target.closest(".card").remove()}},c=class{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keyup",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keyup",this._handleEscClose)}_handleEscClose(e){e.preventDefault(),"Escape"!==e.key&&"Esc"!==e.key||this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close"))&&this.close()}))}},u=class extends c{constructor(e){let{popupSelector:t,handleFormSubmit:s}=e;super({popupSelector:t}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._inputList=this._popupElement.querySelectorAll(".modal__input"),this._handleFormSubmit=s}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._popupForm.reset()}))}};const m=new class{constructor(e){let{userNameSelector:t,userDescriptionSelector:s}=e;this._userName=document.querySelector(t),this._userDescription=document.querySelector(s)}getUserInfo(){return{name:this._userName.textContent,description:this._userDescription.textContent}}setUserInfo(e){let{name:t,description:s}=e;this._userName.textContent=t,this._userDescription.textContent=s}}({userNameSelector:"#profile-title",userDescriptionSelector:".profile__description"}),d=new class extends c{constructor(e){super(e),this._imageElement=this._popupElement.querySelector(".modal__image"),this._imageCaption=this._popupElement.querySelector(".modal__caption")}open(e){this._imageElement.src=e.link,this._imageElement.alt=`Image ${e.name}`,this._imageCaption.textContent=e.name,super.open()}}({popupSelector:"#image-preview-modal"}),p=new u({popupSelector:"#profile-edit-modal",handleFormSubmit:e=>{m.setUserInfo({name:e.title,description:e.description}),p.close()}}),_=new u({popupSelector:"#profile-add-card-modal",handleFormSubmit:e=>{const t=E({name:e.title,link:e.url});h.addItem(t),_.close(),v.disableButton()}}),h=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._element=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._element.prepend(e)}}({renderer:e=>{const t=E(e);h.addItem(t)}},".cards__list"),E=e=>new l({data:e,handleImageClick:()=>{d.open(e)}},"#card-template").generateCard();p.setEventListeners(),_.setEventListeners(),d.setEventListeners(),h.renderItems([{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:" Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}]),n.addEventListener("click",(()=>_.open())),s.addEventListener("click",(()=>{const s=m.getUserInfo();e.value=s.name,t.value=s.description,p.open()}));const v=new a(o,r);v.enableValidation(),new a(o,i).enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUQsR0FFZ0I4QyxrQiIsInNvdXJjZXMiOlsid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcblxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG5cclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG5cclxuICB7XHJcbiAgICBuYW1lOiBcIiBWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcblxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG5leHBvcnQgY29uc3Qgc2VsZWN0b3JzID0ge1xyXG4gIGNhcmRMaXN0OiBcIi5jYXJkc19fbGlzdFwiLFxyXG4gIGNhcmRUZW1wbGF0ZTogXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gIHByZXZpZXdQb3B1cDogXCIjaW1hZ2UtcHJldmlldy1tb2RhbFwiLFxyXG4gIGFkZENhcmRGb3JtOiBcIiNuZXctY2FyZC1mb3JtXCIsXHJcbiAgcHJvZmlsZUVkaXRGb3JtOiBcIiNwcm9maWxlLWVkaXQtZm9ybVwiLFxyXG4gIG5ld0NhcmRNb2RhbDogXCIjcHJvZmlsZS1hZGQtY2FyZC1tb2RhbFwiLFxyXG4gIGVkaXRQcm9maWxlTW9kYWw6IFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVidG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkYnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLWFkZC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBuZXdDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wibmV3LWNhcmQtZm9ybVwiXTtcclxuZXhwb3J0IGNvbnN0IGVkaXRQcm9maWxlRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wicHJvZmlsZS1lZGl0LWZvcm1cIl07XHJcblxyXG5leHBvcnQgY29uc3QgZm9ybVZhbGlkYXRpb25Db25maWcgPSB7XHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zYXZlLWJ0blwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3NhdmUtYnRuX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcblxyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9O1xyXG5cclxuICBfaGlkZUlucHV0RXJyb3IgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gIH07XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcclxuICAgIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXQpID0+IHtcclxuICAgICAgcmV0dXJuICFpbnB1dC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIGRpc2FibGVCdXR0b24gPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICB9O1xyXG5cclxuICBfZW5hYmxlQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH07XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlID0gKCkgPT4ge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XHJcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xyXG5leHBvcnQgKiBmcm9tIFwiLi9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbiIsImNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKHsgZGF0YSwgaGFuZGxlSW1hZ2VDbGljayB9LCBjYXJkU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG5cclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIGNvbnN0IGNhcmRUaXRsZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuXHJcbiAgICBjYXJkSW1hZ2Uuc2V0QXR0cmlidXRlKFwic3JjXCIsIHRoaXMuX2xpbmspO1xyXG4gICAgY2FyZFRpdGxlLnNldEF0dHJpYnV0ZShcImFsdFwiLCB0aGlzLl9uYW1lKTtcclxuICAgIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICBjb25zdCBsaWtlQnRuID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgY29uc3QgZGVsZXRlQnRuID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XHJcblxyXG4gICAgY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soeyBuYW1lOiB0aGlzLl9uYW1lLCBzcmM6IHRoaXMuX2xpbmsgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBsaWtlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVMaWtlSWNvbik7XHJcbiAgICBkZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2VJY29uKGV2dCkge1xyXG4gICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZURlbGV0ZUNhcmQoZXZ0KSB7XHJcbiAgICBldnQudGFyZ2V0LmNsb3Nlc3QoXCIuY2FyZFwiKS5yZW1vdmUoKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENhcmQ7XHJcbiIsImNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZShlKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIgfHwgZS5rZXkgPT09IFwiRXNjXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZSkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikgfHxcclxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcclxuICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwO1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0IH0pIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBmb3JtVmFsdWVzID0ge307XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEZvcm07XHJcbiIsImltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5cclxuaW1wb3J0IHtcclxuICBpbml0aWFsQ2FyZHMsXHJcbiAgc2VsZWN0b3JzLFxyXG4gIGVkaXRQcm9maWxlYnRuLFxyXG4gIGFkZENhcmRidG4sXHJcbiAgbmV3Q2FyZEZvcm0sXHJcbiAgZWRpdFByb2ZpbGVGb3JtLFxyXG4gIHByb2ZpbGVUaXRsZUlucHV0LFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LFxyXG4gIGZvcm1WYWxpZGF0aW9uQ29uZmlnLFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgdXNlck5hbWVTZWxlY3RvcjogXCIjcHJvZmlsZS10aXRsZVwiLFxyXG4gIHVzZXJEZXNjcmlwdGlvblNlbGVjdG9yOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxyXG59KTtcclxuXHJcbmNvbnN0IHBvcHVwV2l0aEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKHtcclxuICBwb3B1cFNlbGVjdG9yOiBzZWxlY3RvcnMucHJldmlld1BvcHVwLFxyXG59KTtcclxuXHJcbmNvbnN0IHVzZXJJbmZvUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XHJcbiAgcG9wdXBTZWxlY3Rvcjogc2VsZWN0b3JzLmVkaXRQcm9maWxlTW9kYWwsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGRhdGEpID0+IHtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHsgbmFtZTogZGF0YS50aXRsZSwgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24gfSk7XHJcbiAgICB1c2VySW5mb1BvcHVwLmNsb3NlKCk7XHJcbiAgfSxcclxufSk7XHJcblxyXG5jb25zdCBuZXdDYXJkUG9wVXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XHJcbiAgcG9wdXBTZWxlY3Rvcjogc2VsZWN0b3JzLm5ld0NhcmRNb2RhbCxcclxuICBoYW5kbGVGb3JtU3VibWl0OiAoY2FyZERhdGEpID0+IHtcclxuICAgIGNvbnN0IGNhcmQgPSBjcmVhdGVDYXJkKHsgbmFtZTogY2FyZERhdGEudGl0bGUsIGxpbms6IGNhcmREYXRhLnVybCB9KTtcclxuICAgIHNlbGVjdG9ycy5jYXJkVGVtcGxhdGU7XHJcbiAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmQpO1xyXG4gICAgbmV3Q2FyZFBvcFVwLmNsb3NlKCk7XHJcbiAgICBhZGRGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcclxuICB9LFxyXG59KTtcclxuXHJcbmNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAge1xyXG4gICAgcmVuZGVyZXI6IChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZCk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgc2VsZWN0b3JzLmNhcmRMaXN0XHJcbik7XHJcblxyXG5jb25zdCBjcmVhdGVDYXJkID0gKGNhcmREYXRhKSA9PiB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAge1xyXG4gICAgICBkYXRhOiBjYXJkRGF0YSxcclxuICAgICAgaGFuZGxlSW1hZ2VDbGljazogKCkgPT4ge1xyXG4gICAgICAgIHBvcHVwV2l0aEltYWdlLm9wZW4oY2FyZERhdGEpO1xyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICAgIHNlbGVjdG9ycy5jYXJkVGVtcGxhdGVcclxuICApO1xyXG4gIHJldHVybiBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG59O1xyXG5cclxudXNlckluZm9Qb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5uZXdDYXJkUG9wVXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxucG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoaW5pdGlhbENhcmRzKTtcclxuXHJcbmFkZENhcmRidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IG5ld0NhcmRQb3BVcC5vcGVuKCkpO1xyXG5cclxuZWRpdFByb2ZpbGVidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCBjdXJyZW50VXNlckluZm8gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gY3VycmVudFVzZXJJbmZvLm5hbWU7XHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBjdXJyZW50VXNlckluZm8uZGVzY3JpcHRpb247XHJcbiAgdXNlckluZm9Qb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuLy9WYWxpZGF0aW9uXHJcblxyXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybVZhbGlkYXRpb25Db25maWcsIG5ld0NhcmRGb3JtKTtcclxuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGZvcm1WYWxpZGF0aW9uQ29uZmlnLFxyXG4gIGVkaXRQcm9maWxlRm9ybVxyXG4pO1xyXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiIsImNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IHVzZXJOYW1lU2VsZWN0b3IsIHVzZXJEZXNjcmlwdGlvblNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX3VzZXJOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyTmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3VzZXJEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckRlc2NyaXB0aW9uU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX3VzZXJEZXNjcmlwdGlvbi50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGRlc2NyaXB0aW9uIH0pIHtcclxuICAgIHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX3VzZXJEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgVXNlckluZm87XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcblxyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5faW1hZ2VDYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XHJcbiAgfVxyXG4gIG9wZW4oZGF0YSkge1xyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LnNyYyA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hbHQgPSBgSW1hZ2UgJHtkYXRhLm5hbWV9YDtcclxuICAgIHRoaXMuX2ltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoSW1hZ2U7XHJcbiIsImNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcyhpdGVtcykge1xyXG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBTZWN0aW9uO1xyXG4iXSwibmFtZXMiOlsicHJvZmlsZVRpdGxlSW5wdXQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsImVkaXRQcm9maWxlYnRuIiwiYWRkQ2FyZGJ0biIsIm5ld0NhcmRGb3JtIiwiZm9ybXMiLCJlZGl0UHJvZmlsZUZvcm0iLCJmb3JtVmFsaWRhdGlvbkNvbmZpZyIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9pbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2VFbGVtZW50IiwiaWQiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiY2xhc3NMaXN0IiwiYWRkIiwiX2hpZGVJbnB1dEVycm9yIiwicmVtb3ZlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0IiwiaW5wdXRMaXN0Iiwic29tZSIsImlucHV0IiwiZGlzYWJsZUJ1dHRvbiIsIl9idXR0b25FbGVtZW50IiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJfaW5wdXRMaXN0IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiZW5hYmxlVmFsaWRhdGlvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJkYXRhIiwiaGFuZGxlSW1hZ2VDbGljayIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9nZXRUZW1wbGF0ZSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJnZW5lcmF0ZUNhcmQiLCJfZWxlbWVudCIsImNhcmRJbWFnZSIsImNhcmRUaXRsZSIsInNldEF0dHJpYnV0ZSIsImxpa2VCdG4iLCJkZWxldGVCdG4iLCJzcmMiLCJfaGFuZGxlTGlrZUljb24iLCJfaGFuZGxlRGVsZXRlQ2FyZCIsImV2dCIsInRhcmdldCIsInRvZ2dsZSIsImNsb3Nlc3QiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJjb250YWlucyIsIlBvcHVwIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2dldElucHV0VmFsdWVzIiwiZm9ybVZhbHVlcyIsInZhbHVlIiwicmVzZXQiLCJ1c2VySW5mbyIsInVzZXJOYW1lU2VsZWN0b3IiLCJ1c2VyRGVzY3JpcHRpb25TZWxlY3RvciIsIl91c2VyTmFtZSIsIl91c2VyRGVzY3JpcHRpb24iLCJnZXRVc2VySW5mbyIsImRlc2NyaXB0aW9uIiwic2V0VXNlckluZm8iLCJfcmVmMiIsInBvcHVwV2l0aEltYWdlIiwiX2ltYWdlRWxlbWVudCIsIl9pbWFnZUNhcHRpb24iLCJhbHQiLCJ1c2VySW5mb1BvcHVwIiwiUG9wdXBXaXRoRm9ybSIsInRpdGxlIiwibmV3Q2FyZFBvcFVwIiwiY2FyZERhdGEiLCJjYXJkIiwiY3JlYXRlQ2FyZCIsInVybCIsImNhcmRTZWN0aW9uIiwiYWRkSXRlbSIsImFkZEZvcm1WYWxpZGF0b3IiLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwicmVuZGVySXRlbXMiLCJpdGVtcyIsIml0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsIkNhcmQiLCJjdXJyZW50VXNlckluZm8iLCJGb3JtVmFsaWRhdG9yIl0sInNvdXJjZVJvb3QiOiIifQ==